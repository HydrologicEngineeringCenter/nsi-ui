import React from 'react';
import { connect } from 'redux-bundler-react';
import LegendItemCorpsMap from './legend-item-corpsmap';
import LegendItemArcGIS from './legend-item-arcgis';
import LegendItemWMS from './legend-item-wms';
import _ from 'lodash';

class LegendPanel extends React.Component {
  constructor(props){
    super(props);
    this.renderItems = this.renderItems.bind(this);
  }

  renderItems(){
    const { visibleLayers } = this.props;
    const sortedLayers = _.sortBy(visibleLayers, ['sortOrder']).reverse();

    return sortedLayers.map((layer, i) => {
      if(layer.type.indexOf('Vector') !== -1) return null; //@TODO legends for vector data
      if(layer.geometryType !== 'SERVICE') return <LegendItemCorpsMap key={i} layer={layer} />
      if(layer.type.indexOf('Arc') !== -1) return <LegendItemArcGIS key={i} layer={layer} />
      return <LegendItemWMS key={i} layer={layer} />
    })
  }

  render(){
    
    return (
      <div>
        <ul className="cm-list-group sidebar-list thin-scrollbar">
          {
            this.renderItems()
          }
        </ul>
      </div>
    )
  }
}

export default connect(
  'selectVisibleLayers',
  LegendPanel
);